(()=>{"use strict";class e{constructor(){this.setControl=()=>{$(".closeModal").on("click",(()=>{this.hidden()})),$("#modalWrapper").on("click",(e=>{e.target.closest("#modalWindow")??this.hidden()})),$("#newEvent").on("click",(()=>{this.show()}))},this.show=()=>{$("#modalWrapper").removeClass("hidden")},this.hidden=()=>{$("#modalWrapper").addClass("hidden")}}}class t{}t.validate=e=>{$(".validationError").remove();let t=!0;const s=new FormData(e);return Array.from(e.elements).forEach((e=>{const n=e.getAttribute("name");if(!n)return!1;"1"!=e.getAttribute("data-require")||s.get(n)||($(e).after("<p style='background-color:red' class='validationError'>！必須項目です</p>"),t=!1)})),t};class s{}s.get=(e,s=!1)=>{if(!e)throw new Error("is not valid form Element");const n=e;if(s&&!t.validate(n))throw new Error("validation error");return new FormData(n)},s.getSameClassValueArray=e=>{const t=Array.from(e);let s=[];return t.forEach((e=>{s.push(e.value)})),s};class n{constructor(){this.send=async(e,t,s,n,r="json",o=!0)=>{let a;a="GET"==t?new Request(e,{method:t,headers:s}):new Request(e,{method:t,headers:s,body:JSON.stringify(n)});const i=await fetch(a).catch((e=>{throw e}));if(!i.ok)throw new Error(i.statusText);if(o)switch(r){case"json":return await this.fetchResonse(i.json()).catch((e=>{throw e}));case"text":return await this.fetchResonse(i.text()).catch((e=>{throw e}))}}}async fetchResonse(e){return await e.then((e=>e)).catch((e=>{throw console.log(e),e}))}}class r{constructor(){this.register=async e=>{(new n).send(this.url,this.method,this.headers,e,this.responseKind).then((e=>{if("1"!=e)throw new Error(e);window.alert("register Collect"),location.reload()})).catch((e=>{console.log(e)}))},this.setRegisterEventListner=()=>{$("#registerButton").on("click",(e=>{try{const e=s.getSameClassValueArray(document.getElementsByClassName("UsersCd")),t=s.get(document.getElementById("registerForm"),!0);t.append("UsersCd",e.join());const n=Object.fromEntries(t.entries());this.register(n)}catch(e){console.log(e)}}))},this.url="/EventList/RegisterEvent",this.method="POST",this.headers={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},this.responseKind="text"}}class o{}o.copyObject=e=>{const t=e.cloneNode(!0);e.after(t)},o.elaseObject=e=>{e.remove()};class a{constructor(){this.setControlObjectHandler=()=>{$("#addUser").on("click",(()=>{const e=this.getLastUserCdObject(document.getElementsByClassName("UsersCdWrapper"));o.copyObject(e)})),$("#delUser").on("click",(()=>{const e=this.getLastUserCdObject(document.getElementsByClassName("UsersCdWrapper"));o.elaseObject(e)}))},this.getLastUserCdObject=e=>{const t=Array.from(e).pop();if(!t)throw new Error("un collect userCdObject");return t}}}class i{constructor(){this.startEvent=async e=>{const t=new n;let s=this.url;s+="?",Object.keys(e).forEach((t=>{s+=t+"="+e[t]+"&"})),s=s.slice(0,-1),t.send(s,this.method,this.headers,null,this.responseKind).then((()=>{location.href=s})).catch((e=>{console.log(e)}))},this.start=()=>{$(".start").on("click",(e=>{const t=e.target.parentElement?.getAttribute("data-eventNumber");t?this.startEvent({EventNumber:t}):console.log("event Number error")}))},this.url="/Event/Index",this.method="GET",this.headers={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},this.responseKind="text"}}class c{constructor(){this.managementStreaming=async e=>{const t=new n;let s=this.url;s+="?",Object.keys(e).forEach((t=>{s+=t+"="+e[t]+"&"})),s=s.slice(0,-1),t.send(s,this.method,this.headers,null,this.responseKind).then((()=>{location.href=s})).catch((e=>{console.log(e)}))},this.management=()=>{$(".management").on("click",(e=>{const t=e.target.parentElement?.getAttribute("data-eventNumber");t?this.managementStreaming({EventNumber:t}):console.log("event Number error")}))},this.url="/ManagementStreaming/Index",this.method="GET",this.headers={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},this.responseKind="text"}}class h{constructor(){this.Streaming=async e=>{const t=new n;let s=this.url;s+="?",Object.keys(e).forEach((t=>{s+=t+"="+e[t]+"&"})),s=s.slice(0,-1),t.send(s,this.method,this.headers,null,this.responseKind).then((()=>{location.href=s})).catch((e=>{console.log(e)}))},this.streaming=()=>{$(".streaming").on("click",(e=>{const t=e.target.parentElement?.getAttribute("data-eventNumber");t?this.Streaming({EventNumber:t}):console.log("event Number error")}))},this.url="/Streaming/Index",this.method="GET",this.headers={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},this.responseKind="text"}}(()=>{const t=new e,s=new r,n=new a,o=new i,l=new c,d=new h;t.setControl(),s.setRegisterEventListner(),n.setControlObjectHandler(),o.start(),l.management(),d.streaming()})()})();